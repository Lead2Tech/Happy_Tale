    <!-- ✅ Turbo用フォールバック（Google Maps遅延対策） -->
    <script>
      document.addEventListener("turbo:load", () => {
        console.log("⚡ Turbo load detected from layout");
        setTimeout(() => {
          if (typeof google !== "undefined" && typeof initMap === "function") {
            console.log("🗺️ Initializing map after Turbo load");
            initMap();
          } else {
            console.warn("⚠️ Google Maps not ready, retrying...");
            setTimeout(() => {
              if (typeof google !== "undefined" && typeof initMap === "function") {
                console.log("✅ Retried initMap successfully");
                initMap();
              }
            }, 1000);
          }
        }, 800);
      });
    </script>

    <!-- 🚨 Google Maps 読み込み失敗時のフォールバック -->
    <script>
      window.addEventListener("error", (e) => {
        if (e.target.tagName === "SCRIPT" && e.target.src.includes("maps.googleapis.com")) {
          console.error("❌ Google Maps の読み込みに失敗しました。APIキーやネットワークを確認してください。");
          const mapDiv = document.getElementById("map");
          if (mapDiv) {
            mapDiv.innerHTML = `
              <p class="text-center text-red-600 mt-6 font-semibold">
                Googleマップの読み込みに失敗しました。再読み込みしてください。
              </p>
            `;
          }
        }
      }, true);
    </script>
  </body>
</html>
